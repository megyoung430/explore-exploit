import pickle
import numpy as np
import matplotlib.pyplot as plt

with open('parameter_sweep_dictionaries.pk1', 'rb') as pickle_file:
    parameter_sweep_dictionaries = pickle.load(pickle_file)

print(len(parameter_sweep_dictionaries))

rand_low_differences = np.zeros(shape=(10,10))
proportions_high = np.zeros(shape=(10,10))
counter = 0
# j represents the alphas
for j in range(10):
    # i represents the beta
    for i in range(10):
        rand_low_differences[j,i] = parameter_sweep_dictionaries[counter]["rand_low_difference"]
        proportions_high[j,i] = parameter_sweep_dictionaries[counter]["proportion_high"]
        counter = counter + 1

proportions_high = proportions_high - proportions_high[0,0]

alpha_start = 0
alpha_end = 4.5
delta_alpha_sweep = np.linspace(alpha_start, alpha_end, num=10, endpoint=True).tolist()

beta_start = 10**0
beta_end = 10**2
delta_beta_sweep = np.logspace(np.log10(beta_start), np.log10(beta_end), num=10, endpoint=True).tolist()
delta_beta_sweep = [round(x, 2) for x in delta_beta_sweep]

min_val = np.min(rand_low_differences)
max_val = np.max(rand_low_differences)
plt.imshow(rand_low_differences, cmap='viridis', vmin=min_val, vmax=max_val)
plt.colorbar()
plt.xticks(np.arange(len(delta_beta_sweep)), delta_beta_sweep)
plt.yticks(np.arange(len(delta_alpha_sweep)), delta_alpha_sweep)
plt.xlabel("Change in Beta with Perturbation (Beta/Delta_Beta)")
plt.ylabel("Change in Alpha with Perturbation (Alpha - Delta-Alpha)")
plt.title("Difference between Choosing the Uncorrelated and Low Arms Across Perturbation Types and Sizes")
plt.show()

min_val = np.min(proportions_high)
max_val = np.max(proportions_high)
plt.imshow(proportions_high, cmap='viridis', vmin=min_val, vmax=max_val)
plt.colorbar()
plt.xticks(np.arange(len(delta_beta_sweep)), delta_beta_sweep)
plt.yticks(np.arange(len(delta_alpha_sweep)), delta_alpha_sweep)
plt.xlabel("Change in Beta with Perturbation (Beta/Delta_Beta)")
plt.ylabel("Change in Alpha with Perturbation (Alpha - Delta-Alpha)")
plt.title("Difference between Choosing the High Arm Before and After Perturbation Across Perturbation Types and Sizes")
plt.show()
