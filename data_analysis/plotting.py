import pickle
import numpy as np
import matplotlib.pyplot as plt

mice = ["MY_61C", "MY_61L", "MY_61R", "MY_62C", "MY_62L", "MY_62R"]

for mouse in mice:
    name = mouse + '_parameter_sweep_dictionaries.pk1'
    with open(name, 'rb') as pickle_file:
        parameter_sweep_dictionaries = pickle.load(pickle_file)

    log_likelihoods  = np.zeros(shape=(50,50))
    counter = 0
    # j represents the alphas
    for j in range(50):
        # i represents the beta
        for i in range(50):
            log_likelihoods[j,i] = parameter_sweep_dictionaries[counter]["likelihood"]
            counter = counter + 1

    alpha_start = -1
    alpha_end = 4
    alpha_sweep = np.linspace(alpha_start, alpha_end, num=50, endpoint=True).tolist()
    alpha_sweep = [round(x, 2) for x in alpha_sweep]

    beta_start = 10**-1
    beta_end = 10**1
    beta_sweep = np.linspace(beta_start, beta_end, num=50, endpoint=True).tolist()
    beta_sweep = [round(x, 2) for x in beta_sweep]

    alpha_indices = np.linspace(0, len(alpha_sweep) - 1, 10, dtype=int)
    beta_indices = np.linspace(0, len(beta_sweep) - 1, 10, dtype=int)

    min_val = np.min(log_likelihoods)
    max_val = np.max(log_likelihoods)
    plt.imshow(log_likelihoods, cmap='viridis', vmin=min_val, vmax=max_val)
    plt.colorbar()
    plt.xticks(beta_indices, [beta_sweep[i] for i in beta_indices])
    plt.yticks(alpha_indices, [alpha_sweep[i] for i in alpha_indices])
    plt.xlabel("Beta")
    plt.ylabel("Alpha")
    plt.title("Log Likelihoods Across Different Parameters for " + mouse)
    plt.show()